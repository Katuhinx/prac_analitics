"QUERY PLAN"
"Sort  (cost=541241.24..541243.49 rows=900 width=128) (actual time=4571.900..4639.114 rows=6308 loops=1)"
"  Sort Key: ((visit.port_departure -> 'city'::text)), visit.year_departure"
"  Sort Method: quicksort  Memory: 1080kB"
"  ->  Finalize GroupAggregate  (cost=541081.44..541197.07 rows=900 width=128) (actual time=4557.191..4636.241 rows=6308 loops=1)"
"        Group Key: cargo.name_product, visit.port_departure, visit.year_departure"
"        ->  Gather Merge  (cost=541081.44..541178.32 rows=750 width=96) (actual time=4557.156..4631.323 rows=6311 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Partial GroupAggregate  (cost=540081.42..540091.73 rows=375 width=96) (actual time=4499.558..4501.997 rows=2104 loops=3)"
"                    Group Key: cargo.name_product, visit.port_departure, visit.year_departure"
"                    ->  Sort  (cost=540081.42..540082.36 rows=375 width=161) (actual time=4498.747..4499.237 rows=2105 loops=3)"
"                          Sort Key: cargo.name_product, visit.port_departure, visit.year_departure"
"                          Sort Method: quicksort  Memory: 423kB"
"                          Worker 0:  Sort Method: quicksort  Memory: 539kB"
"                          Worker 1:  Sort Method: quicksort  Memory: 437kB"
"                          ->  Parallel Hash Join  (cost=36736.90..540065.39 rows=375 width=161) (actual time=762.069..4489.781 rows=2105 loops=3)"
"                                Hash Cond: (cargo.id_visit = visit.id)"
"                                ->  Parallel Seq Scan on cargo  (cost=0.00..481451.72 rows=8333972 width=98) (actual time=0.772..3275.754 rows=6666613 loops=3)"
"                                ->  Parallel Hash  (cost=36736.67..36736.67 rows=19 width=71) (actual time=717.183..717.187 rows=105 loops=3)"
"                                      Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                      ->  Parallel Seq Scan on visit  (cost=0.00..36736.67 rows=19 width=71) (actual time=332.310..716.714 rows=105 loops=3)"
"                                            Filter: ((port_departure @> '{""city"": ""Murmansk""}'::jsonb) AND ((year_departure)::numeric = (EXTRACT(year FROM CURRENT_DATE) - '1'::numeric)))"
"                                            Rows Removed by Filter: 333229"
"Planning Time: 0.261 ms"
"JIT:"
"  Functions: 57"
"  Options: Inlining true, Optimization true, Expressions true, Deforming true"
"  Timing: Generation 3.059 ms, Inlining 244.489 ms, Optimization 433.868 ms, Emission 285.209 ms, Total 966.625 ms"
"Execution Time: 4640.470 ms"
